<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Typing Skill Tester</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #eef2f5;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.container {
    background: #fff;
    width: 560px;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,.15);
}

.logo {
    text-align: center;
}
.logo img {
    width: 80px;
}

h2 {
    text-align: center;
    margin: 10px 0;
}

.text-box {
    background: #f3f3f3;
    padding: 10px;
    border-radius: 5px;
    margin-bottom: 10px;
    font-size: 15px;
}

.correct { color: green; }
.incorrect { color: red; }

textarea {
    width: 100%;
    height: 110px;
    padding: 10px;
    font-size: 15px;
    resize: none;
}

.controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 8px;
}

button {
    padding: 7px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

.start-btn {
    width: 100%;
    margin-top: 10px;
    background: #4CAF50;
    color: white;
    font-size: 16px;
}

.mute-btn {
    background: #ff9800;
    color: white;
}

.popup {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.6);
    display: none;
    justify-content: center;
    align-items: center;
}

.popup-content {
    background: white;
    padding: 25px;
    border-radius: 8px;
    width: 360px;
    text-align: center;
}

.green { color: green; font-weight: bold; }

#studentName{
  border: 2.5px solid darkred;
  border-radius: 5px;
}

#timeSelect{
  border: 2.5px solid darkred;
  border-radius: 5px;
  font-family: Arial;
  margin-bottom: 10px;
}
</style>
</head>

<body>

<div class="container">

    <!-- LOGO -->
    <div class="logo">
        <img src="UNIK-Digital-Skills-Training_Logo.jpg">
    </div>
    <input type="text" id="studentName" placeholder="Enter your full name" required>

    <h2>Typing Skill Test</h2>
    



    <!-- TIME SELECT -->
    <label>
        Select Time:
        <select id="timeSelect">
            <option value="60" selected>1 Minute</option>
            <option value="180" >3 Minutes</option>
            <option value="300">5 Minutes</option>
        </select>
    </label>

    <div class="text-box" id="displayText">
        Technology has become an important part of our daily lives. 
        We use computers to type documents, send emails, browse the internet, and store information.
        Learning basic computer skills helps students work faster, communicate better, and prepare for
        future careers. With regular practice, typing speed and accuracy improve, making tasks easier 
        and more efficient. Using technology responsibly also helps protect personal information and
        promotes safe digital habits.
    </div>

    <textarea id="typingArea" placeholder="Start typing here..." disabled></textarea>

    <div class="controls">
        <div id="timer">Time: 01:00</div>
        <button class="mute-btn" id="muteBtn" onclick="toggleMute()">Mute</button>
    </div>

    <label>
        Volume:
        <input type="range" min="0" max="1" step="0.1" value="0.7" onchange="setVolume(this.value)">
    </label>

    <button class="start-btn" onclick="startTest()">Start Test</button>
</div>

<!-- RESULT POPUP -->
<div class="popup" id="popup">
    <div class="popup-content">
        <h3>Typing Test Complete!</h3>
        <p>Your speed was <span class="green" id="wpm"></span> WPM</p>
        <p>Accuracy: <span class="green" id="accuracy"></span>%</p>
        <button onclick="location.reload()">Restart</button>
    </div>
</div>

<!-- AUDIO -->
<audio id="startSound" src="mixkit-alarm-digital-clock-beep-989.wav"></audio>
<audio id="warnSound" src="https://www.soundjay.com/buttons/sounds/beep-06.mp3"></audio>
<audio id="endSound" src="https://www.soundjay.com/buttons/sounds/beep-07.mp3"></audio>

<script>
const originalText = document.getElementById("displayText").innerText;
const displayText = document.getElementById("displayText");
const typingArea = document.getElementById("typingArea");
const timerDisplay = document.getElementById("timer");
const popup = document.getElementById("popup");

const startSound = document.getElementById("startSound");
const warnSound = document.getElementById("warnSound");
const endSound = document.getElementById("endSound");

let time, timer, muted = false;

function startTest() {
    const name = document.getElementById("studentName").value.trim();

    if (name === "") {
        alert("Please enter your full name before starting the test.");
        return;
    }

    localStorage.setItem("currentStudent", name);

    time = parseInt(document.getElementById("timeSelect").value);
    typingArea.disabled = false;
    typingArea.focus();

    startSound.play();
    timer = setInterval(updateTimer, 1000);
}

function updateTimer() {
    let min = Math.floor(time / 60);
    let sec = time % 60;
    timerDisplay.innerText = `Time: ${min}:${sec < 10 ? '0' : ''}${sec}`;

    if (time <= 10 && time > 0 && !muted) warnSound.play();

    if (time === 0) {
        clearInterval(timer);
        finishTest();
    }
    time--;
}

typingArea.addEventListener("input", () => {
    let typed = typingArea.value;
    let html = "";

    for (let i = 0; i < originalText.length; i++) {
        if (!typed[i]) html += originalText[i];
        else if (typed[i] === originalText[i])
            html += `<span class="correct">${originalText[i]}</span>`;
        else
            html += `<span class="incorrect">${originalText[i]}</span>`;
    }
    displayText.innerHTML = html;
});

function finishTest() {
    typingArea.disabled = true;
    if (!muted) endSound.play();

    let words = typingArea.value.trim().split(/\s+/).length;
    let minutes = parseInt(document.getElementById("timeSelect").value) / 60;
    let wpm = Math.round(words / minutes);

    let correct = 0;
    for (let i = 0; i < typingArea.value.length; i++) {
        if (typingArea.value[i] === originalText[i]) correct++;
    }

    let accuracy = Math.round((correct / typingArea.value.length) * 100 || 0);

    document.getElementById("wpm").innerText = wpm;
    document.getElementById("accuracy").innerText = accuracy;
    popup.style.display = "flex";

    const name = localStorage.getItem("currentStudent");

let allResults = JSON.parse(localStorage.getItem("allResults")) || [];
allResults.push({ name, wpm, accuracy });
localStorage.setItem("allResults", JSON.stringify(allResults));

localStorage.setItem("typingResult", JSON.stringify({
    name, wpm, accuracy
}));

}

function toggleMute() {
    muted = !muted;
    document.getElementById("muteBtn").innerText = muted ? "Unmute" : "Mute";
}

function setVolume(v) {
    startSound.volume = warnSound.volume = endSound.volume = v;
}


function saveToExcel(name, wpm, accuracy) {
    let csv = "Name,WPM,Accuracy\n";
    csv += `${name},${wpm},${accuracy}\n`;

    let blob = new Blob([csv], { type: "text/csv" });
    let link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "typing_results.csv";
    link.click();
}

saveToExcel(studentName, wpm, accuracy);

</script>

</body>
</html>

